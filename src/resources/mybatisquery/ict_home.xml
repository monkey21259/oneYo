<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
          "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="main.ict.home.dao.HomeDAO">

<select id="getRecipeList" resultType="recipevo">

	SELECT	A.RNUM 		AS		RNUM
		   ,A.RSUBJECT 	AS		RSUBJECT 
		   ,A.RPHOTO 	AS		RPHOTO 
		   ,A.RHIT 		AS		RHIT
		   ,NVL((SELECT COUNT(LNUM)
		         FROM "ORCLICT00"."ICT_LIKE" L
		         WHERE A.RNUM = L.LIKETHIS
		         AND   L.LIKEYN = 'Y'), 0)					AS	LIKECNT
		   ,TO_CHAR(TO_DATE(A.INSERTDATE), 'YYYY-MM-DD')	AS	INSERTDATE
	FROM 	"ORCLICT00"."ICT_RECIPE"	A
	WHERE 	A.DELETEYN = 'Y'
	<![CDATA[AND ROWNUM	<=	8]]>
	ORDER BY A.RNUM DESC

</select>

<select id="getTipList" resultType="tipvo">

	SELECT	A.TNUM		AS		TNUM
		   ,A.TSUBJECT	AS		TSUBJECT
		   ,A.TPHOTO	AS		TPHOTO
		   ,A.THIT		AS		THIT
		   ,NVL((SELECT COUNT(LNUM)
		         FROM "ORCLICT00"."ICT_LIKE" L
		         WHERE A.TNUM = L.LIKETHIS
		         AND   L.LIKEYN = 'Y'), 0)					AS	LIKECNT
		   ,TO_CHAR(TO_DATE(A.INSERTDATE), 'YYYY-MM-DD')	AS	INSERTDATE
	FROM	"ORCLICT00"."ICT_TIP"	A
	WHERE	A.DELETEYN = 'Y'
	<![CDATA[AND ROWNUM	<=	8]]>
	ORDER BY A.TNUM DESC

</select>

<select id="getCommunityList" resultType="communityvo">

	SELECT	A.CNUM		AS		CNUM
		   ,A.CSUBJECT	AS		CSUBJECT
		   ,A.CCONTENT	AS		CCONTENT
		   ,A.CHIT		AS		CHIT
		   ,NVL((SELECT COUNT(CNUM)
		         FROM "ORCLICT00"."ICT_LIKE" L
		         WHERE A.CNUM = L.LIKETHIS
		         AND   L.LIKEYN = 'Y'), 0)					AS	LIKECNT
		   ,TO_CHAR(TO_DATE(A.INSERTDATE), 'YYYY-MM-DD')	AS	INSERTDATE
	FROM	"ORCLICT00"."ICT_COMMUNITY"	A
	WHERE	A.DELETEYN ='Y'
	<![CDATA[AND ROWNUM	<=	8]]>
	ORDER BY A.CNUM DESC

</select>

<select id="getNoticeList" resultType="noticevo">

	SELECT	A.NNUM		AS		NNUM
		   ,A.NSUBJECT	AS		NSUBJECT
		   ,A.NCONTENT	AS		NCONTENT
		   ,A.NHIT		AS		NHIT
		   ,TO_CHAR(TO_DATE(A.INSERTDATE), 'YYYY-MM-DD')	AS	INSERTDATE
	FROM	"ORCLICT00"."ICT_NOTICE" A
	WHERE 	A.DELETEYN = 'Y'
	<![CDATA[AND ROWNUM	<=	8]]>
	ORDER BY A.NNUM DESC

</select>

<select id="getMemList" resultType="memvo">

	SELECT	A.MNUM 
		   ,A.MNICK
		   ,A.MPROFILE
		   ,TO_CHAR(TO_DATE(A.INSERTDATE), 'YYYY-MM-DD')	AS	INSERTDATE
	FROM 	"ORCLICT00"."ICT_MEMBER" A
	WHERE	A.DELETEYN ='Y'
	AND     A.MGRADE = 1
	<![CDATA[AND 	ROWNUM <= 14]]>
	ORDER BY A.MNUM DESC

</select>

<select id="getCntList" resultType="homevo">

	SELECT   RECIPECNT
			,COMMUNITYCNT
			,TIPCNT
			,MEMBERCNT
	FROM 	(SELECT COUNT(A.RNUM)		AS		RECIPECNT
			 FROM   "ORCLICT00"."ICT_RECIPE"    A
			 WHERE  A.DELETEYN = 'Y')
		   ,(SELECT COUNT(B.CNUM)		AS		COMMUNITYCNT
		  	 FROM	"ORCLICT00"."ICT_COMMUNITY" B
		  	 WHERE  B.DELETEYN = 'Y')
		   ,(SELECT COUNT(C.TNUM)		AS		TIPCNT
		  	 FROM	"ORCLICT00"."ICT_TIP"		C
		  	 WHERE  C.DELETEYN = 'Y')
		   ,(SELECT COUNT(D.MNUM)		AS		MEMBERCNT
		     FROM   "ORCLICT00"."ICT_MEMBER"	D
		     WHERE	D.DELETEYN = 'Y')

</select>

<select id="homeRestSelectMem" parameterType="memvo" resultType="memvo">

	SELECT		
				A.MNUM		AS		MNUM
		   	   ,A.MNICK		AS		MNICK
		       ,A.MGRADE	AS		MGRADE
		       ,A.MPROFILE	AS		MPROFILE
	FROM 	    "ORCLICT00"."ICT_MEMBER"	A
	WHERE 	    A.MNUM     = #{mnum}
	AND 		A.MGRADE   = '1'
	AND 		A.DELETEYN = 'Y'
	ORDER BY	A.MNUM DESC

</select>

<select id="homeRestSelectRecipe" parameterType="recipevo" resultType="recipevo">

	SELECT  
		    B.RNUM 		AS		RNUM
		   ,B.RSUBJECT 	AS		RSUBJECT
		   ,B.RPHOTO 	AS		RPHOTO
	FROM	(SELECT  
					 MNUM
					,MNICK
					,MGRADE
					,MPROFILE
			 FROM	"ORCLICT00"."ICT_MEMBER"
			 WHERE	DELETEYN = 'Y'
			 AND	MNUM     = #{mnum}
			 AND	MGRADE   = '1'		  	  )		A
		   ,(SELECT 
		   			RNUM
		   		   ,RSUBJECT
		   		   ,RPHOTO
		   		   ,MNUM
		     FROM	"ORCLICT00"."ICT_RECIPE"
		     WHERE	DELETEYN = 'Y'			
		     AND	MNUM 	 = #{mnum}		  )		B
	WHERE	 A.MNUM = B.MNUM
	ORDER BY B.RNUM DESC

</select>

<select id="homeRestSelectTip" parameterType="tipvo" resultType="tipvo">

	SELECT  
		    B.TNUM 		AS		TNUM
		   ,B.TSUBJECT 	AS		TSUBJECT
		   ,B.TPHOTO 	AS		TPHOTO
		   ,TO_CHAR(TO_DATE(B.INSERTDATE), 'YYYY-MM-DD')	AS		INSERTDATE
	FROM	(SELECT  
					 MNUM
					,MNICK
					,MGRADE
					,MPROFILE
					,INSERTDATE
			 FROM	"ORCLICT00"."ICT_MEMBER"
			 WHERE	DELETEYN = 'Y'
			 AND	MNUM     = #{mnum}
			 AND	MGRADE   = '1'		  	  )		A
		   ,(SELECT 
		   			TNUM
		   		   ,TSUBJECT
		   		   ,TPHOTO
		   		   ,INSERTDATE
		   		   ,MNUM
		     FROM	"ORCLICT00"."ICT_TIP"
		     WHERE	DELETEYN = 'Y'			
		     AND	MNUM 	 = #{mnum})				B	
	WHERE	 A.MNUM = B.MNUM
	ORDER BY B.TNUM DESC

</select>

<select id="homeRestSelectCommunity" parameterType="communityvo" resultType="communityvo">

	SELECT  
		    B.CNUM 		AS		CNUM
		   ,B.CSUBJECT 	AS		CSUBJECT
		   ,B.CPHOTO 	AS		CPHOTO
		   ,TO_CHAR(TO_DATE(B.INSERTDATE), 'YYYY-MM-DD')	AS		INSERTDATE
	FROM	(SELECT  
					 MNUM
					,MNICK
					,MGRADE
					,MPROFILE
					,INSERTDATE
			 FROM	"ORCLICT00"."ICT_MEMBER"
			 WHERE	DELETEYN = 'Y'
			 AND	MNUM     = #{mnum}
			 AND	MGRADE   = '1'		  	  )		A
		   ,(SELECT 
		   			CNUM
		   		   ,CSUBJECT
		   		   ,CPHOTO
		   		   ,INSERTDATE
		   		   ,MNUM
		     FROM	"ORCLICT00"."ICT_COMMUNITY"
		     WHERE	DELETEYN = 'Y'			
		     AND	MNUM 	 = #{mnum} )			B
	WHERE	 A.MNUM = B.MNUM
	ORDER BY B.CNUM DESC

</select>

</mapper>